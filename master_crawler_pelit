from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from datetime import datetime, timedelta
import time

driver = webdriver.Chrome()

milta_ajalta = datetime.now() - timedelta(days=30)
unix_timestamp = int(milta_ajalta.timestamp())

url = "https://store.steampowered.com/search/?filter=popularnew&start=0&sort_by=Released_DESC&os=win&hidef=1"

driver.get(url)

games = []

search_results = driver.find_elements(By.CSS_SELECTOR, "#search_resultsRows a")
for game in search_results[:50]:
    try:
        title = game.find_element(By.CLASS_NAME, "title").text
        release_date = game.find_element(By.CSS_SELECTOR, ".search_released").text
        price = game.find_element(By.CSS_SELECTOR, ".discount_final_price").text
        
        games.append({
            "title": title,
            "release_date": release_date,
            "price": price
        })
    except:
        continue

for game in games:
    print(f"{game['title']} - {game['release_date']} - {game['price']}")

import json
with open("master_crawler_pelit.json", "w", encoding="utf-8") as f:
    json.dump(games, f, ensure_ascii=False, indent=4)

driver.quit()

